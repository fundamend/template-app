<html>
	<head>
		<script>
			import CrashService from '@template-app/service-crash-sentry';
			import DependencyContainer from '@template-app/service-dependency-container-awilix';

			import { version } from '@template-app/page-www/package.json';

			const dependencyContainer = new DependencyContainer();

			dependencyContainer.register([
				// values
				{
					type: 'value',
					name: 'ENVIRONMENT',
					value: import.meta.env.PUBLIC_ENVIRONMENT
				},
				{
					type: 'value',
					name: 'SENTRY_DSN',
					value: import.meta.env.PUBLIC_SENTRY_DSN
				},
				{
					type: 'value',
					name: 'SENTRY_TRACE_SAMPLE_RATE',
					value: import.meta.env.PUBLIC_SENTRY_TRACE_SAMPLE_RATE
				},
				{ type: 'value', name: 'VERSION', value: version },
				// classes
				{
					type: 'class',
					name: 'AuthenticationService',
					value: CrashService,
					singleton: true
				}
			]);

			const environment = await dependencyContainer.resolve('ENVIRONMENT');

			if (environment !== 'development') {
				dependencyContainer.resolve('CrashService');
			}
		</script>
	</head>
	<body>
		<slot />
	</body>
</html>
